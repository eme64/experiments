<!DOCTYPE html>
<html>

<body>

TODO

<iframe id = "issue_graph" height="800" width="100%" resize="both" overflow="auto">
</iframe>

<script>
  maxX = 100;
  maxY = 100;

  issues = {}

  graph_document = undefined;

  function updateMax(x,y) {
    maxX = Math.max(maxX,x);
    maxY = Math.max(maxY,y);
  }

  function updateCanvas(overFocusId) {
    var universe = graph_document.getElementById("universe")
    var canv = graph_document.getElementById("mainCanvas")
    canv.width = maxX + 405;
    canv.height = maxY + 25;

    var ctx = canv.getContext("2d");
    ctx.clearRect(0, 0, canv.width, canv.height);

    // Draw edges
    for (const [name, issue] of Object.entries(issues)) {
      for (var edge of issue.edges) {
        var issue2 = issues[edge.name];
        if (issue2 === undefined) {
          console.log("did not find " + edge.name + " from " + name);
          break;
        }
        var x1 = issue.x - 10;
        var y1 = issue.y + 10;
        var x2 = issue2.x - 10;
        var y2 = issue2.y + 10;
        ctx.beginPath();
        ctx.moveTo(x1, y1);
        ctx.bezierCurveTo(x1, y1-30, x2, y2+30, x2, y2);
        ctx.strokeStyle = edge.color;
        ctx.stroke();
      }
    }

    // Draw issues
    for (const [name, issue] of Object.entries(issues)) {
      var div = issue.div;

      if (overFocusId==div.id) {
        div.style.background = issue.color.highlight;
      } else {
        div.style.background = issue.color.background;
      }

      ctx.beginPath();
      ctx.arc(issue.x - 10, issue.y + 10, issue.radius, 0, 2 * Math.PI);
      ctx.fillStyle = issue.color.dot;
      ctx.fill();
    }
  }

  function addIssue(issue) {
    var universe = graph_document.getElementById('universe')
    universe.style.position = "absolute";
    var div = graph_document.createElement("myelement");
    div.style.position = "absolute";
    div.style.width = "400px";
    div.style.height = "20px";
    div.style.background = "#ffffff";
    div.style.color = "black";
    div.innerHTML = "<a href='https://bugs.openjdk.org/browse/JDK-" + issue.name
                    + "' style='font-size:14px' target='_blank'>"
                    + issue.name + ": " + issue.desc + "</a>";
    if (issue.pr != "") {
      div.innerHTML += " <a href='" + issue.pr
                       + "' style='font-size:14px' target='_blank'>[PR]</a>";
    }
    div.innerHTML += " (" + issue.assigned + ")";

    div.style.left = issue.x+"px";
    div.style.top  = issue.y+"px";
    updateMax(issue.x, issue.y);

    div.id = issue.name;
    universe.appendChild(div);

    div.onmouseover = function() {mouseOverIssue(div.id);}

    return div;
  }

  function mouseOverIssue(id) {
    updateCanvas(id);
  }

  function init() {
    var graph_frame = document.getElementById("issue_graph")
    graph_document = graph_frame.contentWindow.document

    var div = graph_document.createElement("div");
    graph_document.body.appendChild(div);

    var universe =  graph_document.createElement('universe');
    universe.id = "universe";
    div.appendChild(universe);

    var canv = graph_document.createElement('canvas');
    canv.id = 'mainCanvas';
    universe.appendChild(canv);

    issues = {};

    var bug_open = {dot: "#ff0000", background: "#ff9999", highlight: "#ff8888"}
    var bug_done = {dot: "#ff9999", background: "#ffeeee", highlight: "#ffdddd"}
    var rfe_open = {dot: "#0000ff", background: "#9999ff", highlight: "#8888ff"}
    var rfe_done = {dot: "#9999ff", background: "#eeeeff", highlight: "#ddddff"}

    issues["8346993"] = {desc:"Refactor VectorNode::make",
                         assigned:"Emanuel",
                         pr: "https://github.com/openjdk/jdk/pull/22917",
                         x: 20, y: 10, color: bug_open, radius: 3,
                         edges: []};
    issues["8343685"] = {desc:"Revactor VPointer with MemPointer",
                         assigned:"Emanuel",
                         pr: "https://github.com/openjdk/jdk/pull/21926",
                         x: 200, y: 50, color: bug_done, radius: 7,
                         edges: [{name: "8346993", color: "black"}]};



    var x = 0;
    var y = 0;

    // -------------------------- General Bugs
    x = 20;
    y = 120;
    issues["8316679"] = {desc:"wrong result - load/store order",
                         assigned:"Emanuel",
                         jdk: 22,
                         pr: "https://github.com/openjdk/jdk/pull/15864",
                         x: x, y: y, color: bug_done, radius: 3,
                         edges: []};
    y += 25;
    issues["8316594"] = {desc:"wrong result - load/store order",
                         assigned:"Emanuel",
                         jdk: 22,
                         pr: "https://github.com/openjdk/jdk/pull/15866",
                         x: x, y: y, color: bug_done, radius: 3,
                         edges: [{name: "8316679", color: "black"}]};
    y += 25;
    issues["8310190"] = {desc:"AlignVector broken",
                         assigned:"Emanuel",
                         jdk: 23,
                         pr: "https://github.com/openjdk/jdk/pull/14785",
                         x: x, y: y, color: bug_done, radius: 7,
                         edges: [{name: "8316594", color: "black"}]};


    y += 25;
    issues["8332905"] = {desc:"bad AD with RotateRightV",
                         assigned:"Emanuel",
                         jdk: 23,
                         pr: "https://github.com/openjdk/jdk/pull/19445",
                         x: x, y: y, color: bug_done, radius: 3,
                         edges: []};
    y += 25;
    issues["8330819"] = {desc:"bad dominance - CastLL after pre-loop",
                         assigned:"Emanuel",
                         jdk: 23,
                         pr: "https://github.com/openjdk/jdk/pull/pull/18892",
                         x: x, y: y, color: bug_done, radius: 3,
                         edges: []};
    y += 25;


    //issues[""] = {desc:"",
    //                     assigned:"Emanuel",
    //                     jdk: 0,
    //                     pr: "https://github.com/openjdk/jdk/pull/",
    //                     x: x, y: y, color: bug_done, radius: 5,
    //                     edges: []};


    // -------------------------- Reductions
    x = 500;
    y = 120;
    issues["8302652"] = {desc:"Move unordered reduction out of loop",
                         assigned:"Emanuel",
                         jdk: 21,
                         pr: "https://github.com/openjdk/jdk/pull/13056",
                         x: x, y: y, color: rfe_done, radius: 5,
                         edges: []};
    y += 25;
    issues["8314612"] = {desc:"wrong result - unordered reductions",
                         assigned:"Emanuel",
                         jdk: 22,
                         pr: "https://github.com/openjdk/jdk/pull/15654",
                         x: x+20, y: y, color: bug_done, radius: 5,
                         edges: [{name: "8302652", color: "red"}]};
    y += 25;


    // -------------------------- CMove
    x = 950;
    y = 120;

    issues["8306302"] = {desc:"assert with CMove - fix and refactor",
                         assigned:"Emanuel",
                         jdk: 21,
                         pr: "https://github.com/openjdk/jdk/pull/13493",
                         x: x, y: y, color: bug_done, radius: 5,
                         edges: []};
    y += 25;


    issues["8313720"] = {desc:"wrong result - CMove",
                         assigned:"Emanuel",
                         jdk: 22,
                         pr: "https://github.com/openjdk/jdk/pull/15274",
                         x: x+20, y: y, color: bug_done, radius: 3,
                         edges: [{name: "8306302", color: "red"}]};
    y += 25;

    //issues[""] = {desc:"",
    //                     assigned:"Emanuel",
    //                     jdk: 0,
    //                     pr: "https://github.com/openjdk/jdk/pull/",
    //                     x: x, y: y, color: rfe_done, radius: 5,
    //                     edges: []};


    for (const [name, issue] of Object.entries(issues)) {
      issue.name = name;
      div = addIssue(issue)
      issue.div = div;
    }

    updateCanvas()
  }

  init()
</script>

TODO

</body>
</html>
